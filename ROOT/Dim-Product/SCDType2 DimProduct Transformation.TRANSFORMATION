{"job":{"components":{"117554":{"id":117554,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":576,"y":336,"width":32,"height":32,"inputConnectorIDs":[117564],"outputConnectorIDs":[117562],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calculator - Add End Date"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GETDATE()"},"2":{"slot":2,"type":"STRING","value":"dim_product_enddate"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"'N'"},"2":{"slot":2,"type":"STRING","value":"dim_product_currentflag"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"117555":{"id":117555,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":256,"y":336,"width":32,"height":32,"inputConnectorIDs":[117565],"outputConnectorIDs":[117563],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter Changes"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"indicator"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"C"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"117556":{"id":117556,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":736,"y":336,"width":32,"height":32,"inputConnectorIDs":[117562],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product UPD"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ownertableprefix}dim_product"}}}},"visible":true},"3":{"slot":3,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_prodno"},"2":{"slot":2,"type":"STRING","value":"dim_product_prodno"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_description"},"2":{"slot":2,"type":"STRING","value":"dim_product_description"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_category"},"2":{"slot":2,"type":"STRING","value":"dim_product_category"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_cost"},"2":{"slot":2,"type":"STRING","value":"dim_product_cost"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_price"},"2":{"slot":2,"type":"STRING","value":"dim_product_price"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_childprodno"},"2":{"slot":2,"type":"STRING","value":"dim_product_childprodno"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_firstorderdate"},"2":{"slot":2,"type":"STRING","value":"dim_product_firstorderdate"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_currentflag"},"2":{"slot":2,"type":"STRING","value":"dim_product_currentflag"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_startdate"},"2":{"slot":2,"type":"STRING","value":"dim_product_startdate"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_enddate"},"2":{"slot":2,"type":"STRING","value":"dim_product_enddate"}}}},"visible":true},"5":{"slot":5,"name":"Unique Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_prodno"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_startdate"}}}},"visible":true},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Update Strategy","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Delete/Insert"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"117557":{"id":117557,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":736,"y":176,"width":32,"height":32,"inputConnectorIDs":[117569],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product INS"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ownertableprefix}dim_product"}}}},"visible":true},"3":{"slot":3,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_prodno"},"2":{"slot":2,"type":"STRING","value":"dim_product_prodno"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_description"},"2":{"slot":2,"type":"STRING","value":"dim_product_description"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_category"},"2":{"slot":2,"type":"STRING","value":"dim_product_category"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_cost"},"2":{"slot":2,"type":"STRING","value":"dim_product_cost"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_price"},"2":{"slot":2,"type":"STRING","value":"dim_product_price"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_childprodno"},"2":{"slot":2,"type":"STRING","value":"dim_product_childprodno"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_firstorderdate"},"2":{"slot":2,"type":"STRING","value":"dim_product_firstorderdate"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_currentflag"},"2":{"slot":2,"type":"STRING","value":"dim_product_currentflag"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_startdate"},"2":{"slot":2,"type":"STRING","value":"dim_product_startdate"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_enddate"},"2":{"slot":2,"type":"STRING","value":"dim_product_enddate"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true},"6":{"slot":6,"name":"Automatic Compression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"117558":{"id":117558,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":128170095,"x":416,"y":336,"width":32,"height":32,"inputConnectorIDs":[117563],"outputConnectorIDs":[117564],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rename Old Row Cols"}}}},"visible":true},"2":{"slot":2,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_prodno"},"2":{"slot":2,"type":"STRING","value":"dim_product_prodno"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"master_dim_product_description"},"2":{"slot":2,"type":"STRING","value":"dim_product_description"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"master_dim_product_category"},"2":{"slot":2,"type":"STRING","value":"dim_product_category"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"master_dim_product_cost"},"2":{"slot":2,"type":"STRING","value":"dim_product_cost"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"master_dim_product_price"},"2":{"slot":2,"type":"STRING","value":"dim_product_price"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"master_dim_product_childprodno"},"2":{"slot":2,"type":"STRING","value":"dim_product_childprodno"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"master_dim_product_firstorderdate"},"2":{"slot":2,"type":"STRING","value":"dim_product_firstorderdate"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"master_dim_product_startdate"},"2":{"slot":2,"type":"STRING","value":"dim_product_startdate"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"indicator"},"2":{"slot":2,"type":"STRING","value":"indicator"}}}},"visible":true},"3":{"slot":3,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"117559":{"id":117559,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":576,"y":176,"width":32,"height":32,"inputConnectorIDs":[117566],"outputConnectorIDs":[117569],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calculator - Set Start Date"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"'Y'"},"2":{"slot":2,"type":"STRING","value":"dim_product_currentflag"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"case \"indicator\" when 'N' then CAST ('${default_startdate}' AS DATETIME) else GETDATE() end"},"2":{"slot":2,"type":"STRING","value":"dim_product_startdate"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"--convert job variable to datetime for enddate column\nCAST ('${default_enddate}' AS DATETIME)"},"2":{"slot":2,"type":"STRING","value":"dim_product_enddate"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"117560":{"id":117560,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":96,"y":176,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[117565,117567],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_tmp"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${ownertableprefix}dim_product_tmp"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_prodno"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"master_dim_product_description"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"compare_dim_product_description"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"master_dim_product_category"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"compare_dim_product_category"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"master_dim_product_cost"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"compare_dim_product_cost"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"master_dim_product_price"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"compare_dim_product_price"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"master_dim_product_childprodno"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"compare_dim_product_childprodno"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"master_dim_product_firstorderdate"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"compare_dim_product_firstorderdate"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"master_dim_product_startdate"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"compare_dim_product_startdate"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"indicator"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"117561":{"id":117561,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":128170095,"x":416,"y":176,"width":32,"height":32,"inputConnectorIDs":[117567],"outputConnectorIDs":[117566],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rename New Row Cols"}}}},"visible":true},"2":{"slot":2,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_product_prodno"},"2":{"slot":2,"type":"STRING","value":"dim_product_prodno"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"compare_dim_product_description"},"2":{"slot":2,"type":"STRING","value":"dim_product_description"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"compare_dim_product_category"},"2":{"slot":2,"type":"STRING","value":"dim_product_category"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"compare_dim_product_cost"},"2":{"slot":2,"type":"STRING","value":"dim_product_cost"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"compare_dim_product_price"},"2":{"slot":2,"type":"STRING","value":"dim_product_price"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"compare_dim_product_childprodno"},"2":{"slot":2,"type":"STRING","value":"dim_product_childprodno"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"compare_dim_product_firstorderdate"},"2":{"slot":2,"type":"STRING","value":"dim_product_firstorderdate"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"compare_dim_product_startdate"},"2":{"slot":2,"type":"STRING","value":"dim_product_startdate"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"indicator"},"2":{"slot":2,"type":"STRING","value":"indicator"}}}},"visible":true},"3":{"slot":3,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"117562":{"id":117562,"sourceID":117554,"targetID":117556},"117563":{"id":117563,"sourceID":117555,"targetID":117558},"117564":{"id":117564,"sourceID":117558,"targetID":117554},"117565":{"id":117565,"sourceID":117560,"targetID":117555},"117566":{"id":117566,"sourceID":117561,"targetID":117559},"117567":{"id":117567,"sourceID":117560,"targetID":117561},"117569":{"id":117569,"sourceID":117559,"targetID":117557}},"notes":{"117551":{"id":117551,"x":168,"y":247,"width":629,"height":130,"text":"Find copies of the old records stored in the temporary working table, which are the rows marked as 'C'hanged, and stored in the Master columns, and use the ProductNo and original StartDate key values to find the correct current row in the Dimension and set the EndDate to now. \n","colour":"e6e63c"},"117552":{"id":117552,"x":83,"y":-153,"width":468,"height":147,"text":"**Job Name     :  **\nSCDType2 DimProduct Transformation\n\n**Job Variable  :  **\ndefault_enddate, used to define the enddate of current rows\n\n**Description  :   **\nUses the contents of the temporary working table, containing details of the 'N'ew and 'C'hanged records, to end date any old versions of an Product record, and create new records with a corresponding StartDatre.","colour":"f9c21b"},"117553":{"id":117553,"x":245,"y":86,"width":550,"height":134,"text":"No need to filter by Indicator, as whether a record is 'C'hanged or 'N'ew, we need to create a new current row for each ProductNo affected. \nUse the new data stored in the Compare columns for both 'C'hanged and 'N'ew rows, set the StartDate to now and insert new rows for each ProductNo.","colour":"e6e63c"}},"noteConnectors":{},"variables":{"default_enddate":{"definition":{"name":"default_enddate","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"2099-12-31 23:59:59"},"default_startdate":{"definition":{"name":"default_startdate","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"2020-01-01 00:00:00"}},"grids":{}},"info":{"name":"SCDType2 DimProduct Transformation","description":"","type":"TRANSFORMATION","tag":"21f70675-32f4-411b-a5f4-cc7110e80fc7"}}